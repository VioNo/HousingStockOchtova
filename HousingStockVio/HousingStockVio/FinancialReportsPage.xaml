<Page x:Class="HousingStockVio.FinancialReportsPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Финансовые отчеты"
      Background="#FFFFFFFF">

    <Page.Resources>
        <ResourceDictionary Source="Styles.xaml"/>
    </Page.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Верхняя панель -->
        <Border Grid.Row="0" 
                Background="#FFFFFFFF"
                BorderBrush="#FFCCCCCC"
                BorderThickness="0,0,0,1"
                Padding="30,25">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Заголовок -->
                <StackPanel Grid.Column="0">
                    <TextBlock Text="ФИНАНСОВЫЕ ОТЧЕТЫ"
                              FontFamily="Segoe UI"
                              FontSize="28"
                              FontWeight="Bold"
                              Foreground="#FF333333"/>

                    <TextBlock Text="Анализ и управление финансами системы"
                              FontFamily="Segoe UI"
                              FontSize="14"
                              Foreground="#FF666666"
                              Margin="0,5,0,0"/>
                </StackPanel>

                <!-- Кнопки управления -->
                <StackPanel Grid.Column="1" 
                           Orientation="Horizontal" 
                           VerticalAlignment="Center">
                    <Button x:Name="ExportToExcelButton"
                            Content="📊 Экспорт в Excel"
                            Style="{StaticResource PrimaryButton}"
                            Height="45"
                            MinWidth="150"
                            Click="ExportToExcelButton_Click"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Основное содержимое -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <Grid Margin="30">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Первая строка: Основные показатели -->
                <Grid Grid.Row="0" Margin="0,0,0,30">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Доход -->
                    <Border Grid.Column="0" 
                            Background="#FFF4E8D3"
                            CornerRadius="12"
                            Margin="0,0,15,0"
                            Padding="25">
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                                <TextBlock Text="📈"
                                          FontSize="24"
                                          VerticalAlignment="Center"/>
                                <TextBlock Text="Доход"
                                          FontFamily="Segoe UI"
                                          FontSize="16"
                                          FontWeight="SemiBold"
                                          Foreground="#FF333333"
                                          Margin="10,0,0,0"
                                          VerticalAlignment="Center"/>
                            </StackPanel>

                            <TextBlock x:Name="MonthlyIncomeText" 
                                      Text="0 руб."
                                      FontFamily="Segoe UI"
                                      FontSize="28"
                                      FontWeight="Bold"
                                      Foreground="#FF27AE60"/>

                            <TextBlock Text="за текущий месяц"
                                      FontFamily="Segoe UI"
                                      FontSize="14"
                                      Foreground="#FF666666"
                                      Margin="0,8,0,0"/>
                        </StackPanel>
                    </Border>

                    <!-- Расходы -->
                    <Border Grid.Column="1" 
                            Background="#FFF4E8D3"
                            CornerRadius="12"
                            Margin="0,0,15,0"
                            Padding="25">
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                                <TextBlock Text="📉"
                                          FontSize="24"
                                          VerticalAlignment="Center"/>
                                <TextBlock Text="Расходы"
                                          FontFamily="Segoe UI"
                                          FontSize="16"
                                          FontWeight="SemiBold"
                                          Foreground="#FF333333"
                                          Margin="10,0,0,0"
                                          VerticalAlignment="Center"/>
                            </StackPanel>

                            <TextBlock x:Name="MonthlyExpensesText" 
                                      Text="0 руб."
                                      FontFamily="Segoe UI"
                                      FontSize="28"
                                      FontWeight="Bold"
                                      Foreground="#FFE74C3C"/>

                            <TextBlock Text="за текущий месяц"
                                      FontFamily="Segoe UI"
                                      FontSize="14"
                                      Foreground="#FF666666"
                                      Margin="0,8,0,0"/>
                        </StackPanel>
                    </Border>

                    <!-- Прибыль -->
                    <Border Grid.Column="2" 
                            Background="#FFF4E8D3"
                            CornerRadius="12"
                            Margin="0,0,15,0"
                            Padding="25">
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                                <TextBlock Text="💰"
                                          FontSize="24"
                                          VerticalAlignment="Center"/>
                                <TextBlock Text="Чистая прибыль"
                                          FontFamily="Segoe UI"
                                          FontSize="16"
                                          FontWeight="SemiBold"
                                          Foreground="#FF333333"
                                          Margin="10,0,0,0"
                                          VerticalAlignment="Center"/>
                            </StackPanel>

                            <TextBlock x:Name="NetProfitText" 
                                      Text="0 руб."
                                      FontFamily="Segoe UI"
                                      FontSize="28"
                                      FontWeight="Bold"
                                      Foreground="#FF333333"/>

                            <TextBlock x:Name="ProfitabilityText"
                                      Text="рентабельность 0%"
                                      FontFamily="Segoe UI"
                                      FontSize="14"
                                      Foreground="#FF666666"
                                      Margin="0,8,0,0"/>
                        </StackPanel>
                    </Border>

                    <!-- Собрано и задолженность -->
                    <Border Grid.Column="3" 
                            Background="#FFF4E8D3"
                            CornerRadius="12"
                            Padding="25">
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                                <TextBlock Text="💳"
                                          FontSize="24"
                                          VerticalAlignment="Center"/>
                                <TextBlock Text="Финансовый статус"
                                          FontFamily="Segoe UI"
                                          FontSize="16"
                                          FontWeight="SemiBold"
                                          Foreground="#FF333333"
                                          Margin="10,0,0,0"
                                          VerticalAlignment="Center"/>
                            </StackPanel>

                            <TextBlock x:Name="CollectedPaymentsText" 
                                      Text="0 руб."
                                      FontFamily="Segoe UI"
                                      FontSize="20"
                                      FontWeight="Bold"
                                      Foreground="#FF27AE60"/>

                            <TextBlock Text="собрано платежей"
                                      FontFamily="Segoe UI"
                                      FontSize="12"
                                      Foreground="#FF666666"
                                      Margin="0,4,0,0"/>

                            <TextBlock x:Name="TotalDebtText" 
                                      Text="0 руб."
                                      FontFamily="Segoe UI"
                                      FontSize="20"
                                      FontWeight="Bold"
                                      Foreground="#FFE74C3C"
                                      Margin="0,10,0,0"/>

                            <TextBlock Text="общая задолженность"
                                      FontFamily="Segoe UI"
                                      FontSize="12"
                                      Foreground="#FF666666"
                                      Margin="0,4,0,0"/>
                        </StackPanel>
                    </Border>
                </Grid>

                <!-- Вторая строка: Быстрые действия -->
                <Border Grid.Row="1" 
                        Background="#FFFFFFFF"
                        BorderBrush="#FFCCCCCC"
                        BorderThickness="1"
                        CornerRadius="12"
                        Margin="0,0,0,30"
                        Padding="30">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock Text="БЫСТРЫЕ ОТЧЕТЫ"
                                  FontFamily="Segoe UI"
                                  FontSize="20"
                                  FontWeight="Bold"
                                  Foreground="#FF333333"
                                  Grid.Row="0"
                                  Margin="0,0,0,20"/>

                        <StackPanel Grid.Row="1" Orientation="Horizontal">
                            <Button x:Name="GenerateMonthlyReportButton"
                                    Content="📅 Ежемесячный отчет"
                                    Style="{StaticResource PrimaryButton}"
                                    Height="50"
                                    MinWidth="180"
                                    Margin="0,0,15,0"
                                    Click="GenerateMonthlyReportButton_Click"/>

                            <Button x:Name="GenerateQuarterlyReportButton"
                                    Content="📊 Квартальный отчет"
                                    Style="{StaticResource PrimaryButton}"
                                    Height="50"
                                    MinWidth="180"
                                    Margin="0,0,15,0"
                                    Click="GenerateQuarterlyReportButton_Click"/>

                            <Button x:Name="GenerateAnnualReportButton"
                                    Content="📈 Годовой отчет"
                                    Style="{StaticResource PrimaryButton}"
                                    Height="50"
                                    MinWidth="180"
                                    Click="GenerateAnnualReportButton_Click"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- Третья строка: Таблицы -->
                <Grid Grid.Row="2">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Последние платежи -->
                    <Border Grid.Column="0" 
                            Background="#FFFFFFFF"
                            BorderBrush="#FFCCCCCC"
                            BorderThickness="1"
                            CornerRadius="12"
                            Margin="0,0,15,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- Заголовок таблицы -->
                            <Border Grid.Row="0" 
                                    Background="#FF67BA80"
                                    CornerRadius="12,12,0,0"
                                    Padding="20,15">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <TextBlock Text="ПОСЛЕДНИЕ ПЛАТЕЖИ"
                                              FontFamily="Segoe UI"
                                              FontSize="16"
                                              FontWeight="Bold"
                                              Foreground="#FFFFFFFF"
                                              VerticalAlignment="Center"/>

                                    <Button x:Name="RefreshButton"
                                            Content="Обновить" 
                                            Grid.Column="1"
                                            Style="{StaticResource SecondaryButton}"
                                            Height="35" 
                                            MinWidth="100"
                                            Foreground="#FFFFFFFF"
                                            Background="Transparent"
                                            BorderBrush="#FFFFFFFF"
                                            Click="RefreshButton_Click"/>
                                </Grid>
                            </Border>

                            <!-- Таблица -->
                            <ListView x:Name="RecentPaymentsList" 
                                     Grid.Row="1"
                                     BorderThickness="0"
                                     Height="250">
                                <ListView.View>
                                    <GridView>
                                        <GridViewColumn Header="Дата" Width="100">
                                            <GridViewColumn.DisplayMemberBinding>
                                                <Binding Path="PaymentDate" StringFormat="dd.MM.yyyy"/>
                                            </GridViewColumn.DisplayMemberBinding>
                                        </GridViewColumn>
                                        <GridViewColumn Header="Владелец" Width="150" 
                                                       DisplayMemberBinding="{Binding OwnerName}"/>
                                        <GridViewColumn Header="Период" Width="100" 
                                                       DisplayMemberBinding="{Binding Period}"/>
                                        <GridViewColumn Header="Начислено" Width="100">
                                            <GridViewColumn.DisplayMemberBinding>
                                                <Binding Path="Accrued" StringFormat="N2"/>
                                            </GridViewColumn.DisplayMemberBinding>
                                        </GridViewColumn>
                                        <GridViewColumn Header="Оплачено" Width="100">
                                            <GridViewColumn.DisplayMemberBinding>
                                                <Binding Path="Paid" StringFormat="N2"/>
                                            </GridViewColumn.DisplayMemberBinding>
                                        </GridViewColumn>
                                    </GridView>
                                </ListView.View>
                            </ListView>
                        </Grid>
                    </Border>

                    <!-- Должники -->
                    <Border Grid.Column="1" 
                            Background="#FFFFFFFF"
                            BorderBrush="#FFCCCCCC"
                            BorderThickness="1"
                            CornerRadius="12">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- Заголовок таблицы -->
                            <Border Grid.Row="0" 
                                    Background="#FF67BA80"
                                    CornerRadius="12,12,0,0"
                                    Padding="20,15">
                                <TextBlock Text="КРУПНЕЙШИЕ ДОЛЖНИКИ"
                                          FontFamily="Segoe UI"
                                          FontSize="16"
                                          FontWeight="Bold"
                                          Foreground="#FFFFFFFF"/>
                            </Border>

                            <!-- Таблица -->
                            <ListView x:Name="DebtorsList" 
                                     Grid.Row="1"
                                     BorderThickness="0"
                                     Height="250">
                                <ListView.View>
                                    <GridView>
                                        <GridViewColumn Header="Владелец" Width="180" 
                                                       DisplayMemberBinding="{Binding OwnerName}"/>
                                        <GridViewColumn Header="Задолженность" Width="120">
                                            <GridViewColumn.DisplayMemberBinding>
                                                <Binding Path="TotalDebt" StringFormat="N2"/>
                                            </GridViewColumn.DisplayMemberBinding>
                                        </GridViewColumn>
                                        <GridViewColumn Header="Вода" Width="90">
                                            <GridViewColumn.DisplayMemberBinding>
                                                <Binding Path="WaterDebt" StringFormat="N2"/>
                                            </GridViewColumn.DisplayMemberBinding>
                                        </GridViewColumn>
                                        <GridViewColumn Header="Электричество" Width="100">
                                            <GridViewColumn.DisplayMemberBinding>
                                                <Binding Path="ElectricityDebt" StringFormat="N2"/>
                                            </GridViewColumn.DisplayMemberBinding>
                                        </GridViewColumn>
                                    </GridView>
                                </ListView.View>
                            </ListView>
                        </Grid>
                    </Border>
                </Grid>
            </Grid>
        </ScrollViewer>
    </Grid>
</Page>